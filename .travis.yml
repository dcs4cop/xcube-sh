#
# This is a basic build configuration for Travis CI.
# See http://conda.pydata.org/docs/travis.html for more info.
#

language: bash

os:
  - linux
#  - osx
#  - windows

install:
#  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then
#      wget https://repo.continuum.io/miniconda/Miniconda3-latest-MacOSX-x86_64.sh -O miniconda.sh;
#      bash miniconda.sh -b -p $HOME/miniconda;
#      export PATH="$HOME/miniconda/bin:$PATH";
#    elif [[ "$TRAVIS_OS_NAME" == "windows" ]]; then
#      choco install -y openssl;
#      choco install -y miniconda3;
#      export PATH="/c/tools/miniconda3/Scripts:$PATH";
#      source activate base;
#    else
#      wget https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh -O miniconda.sh;
#      bash miniconda.sh -b -p $HOME/miniconda;
#      export PATH="$HOME/miniconda/bin:$PATH";
#    fi
  - wget https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh -O miniconda.sh
  - bash miniconda.sh -b -p $HOME/miniconda
  - export PATH="$HOME/miniconda/bin:$PATH"
  - git clone https://github.com/dcs4cop/xcube
  - conda install -y mamba -c conda-forge
  - conda info
  - sed 's/- blas/#- blas/g' xcube/environment.yml
  - mamba env create -f xcube/environment.yml
  - source activate xcube
  - mamba env update -n xcube
  - python setup.py install

script:
  - py.test -v --cov=xcube_sh
  - pip install codecov
  - codecov --env TRAVIS_PYTHON_VERSION




